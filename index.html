<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Irys Shooter</title>
  <link rel="stylesheet" href="styles/style.css">
</head>
<body>
  <div id="app">
    <div style="color: white; text-align: center; padding: 50px;">
      <h1>Loading...</h1>
      <p>If this message persists, check the browser console for errors.</p>
    </div>
  </div>
  
  <!-- ethers.js CDN -->
  <script 
    src="https://unpkg.com/ethers@5.7.2/dist/ethers.umd.min.js"
    onload="console.log('‚úÖ ethers.js loaded successfully:', typeof ethers !== 'undefined' ? ethers.version : 'FAILED')"
    onerror="console.error('‚ùå Failed to load ethers.js from CDN')"
  ></script>
  
  <!-- Load Irys Contract Integration -->
  <script src="./irys-contract-integration.js" 
    onload="console.log('‚úÖ IrysContractIntegration loaded:', typeof window.IrysContractIntegration !== 'undefined')"
    onerror="console.error('‚ùå Failed to load irys-contract-integration.js')"></script>
  
  <!-- Load Irys Network Integration as fallback -->
  <script src="./js/simple-blockchain-integration.js" 
    onload="console.log('‚úÖ SimpleBlockchainIntegration loaded:', typeof window.SimpleBlockchainIntegration !== 'undefined')"
    onerror="console.error('‚ùå Failed to load simple-blockchain-integration.js')"></script>
  
  <!-- Inline fallback integration for production -->
  <script>
    // Inline fallback if external scripts fail to load
    if (typeof window.SimpleBlockchainIntegration === 'undefined') {
      console.log('üîÑ Creating inline fallback integration...');
      
      window.SimpleBlockchainIntegration = {
        async initialize(provider) {
          console.log('üîÑ Inline fallback: Initializing...');
          try {
            if (typeof ethers === 'undefined') {
              throw new Error('ethers.js not available');
            }
            
            // Simple initialization without network switching for fallback
            const ethersProvider = new ethers.providers.Web3Provider(provider);
            const network = await ethersProvider.getNetwork();
            console.log(`üåê Connected to network: ${network.chainId}`);
            
            return true;
          } catch (error) {
            console.error('‚ùå Inline fallback failed:', error);
            return false;
          }
        },
        
        async startGameSession(gameMode, walletAddress) {
          console.log(`üöÄ Inline fallback: Starting ${gameMode} game session`);
          
          // Mock successful transaction for fallback
          return {
            success: true,
            smartContractTxHash: '0x' + Math.random().toString(16).substr(2, 64),
            irysTransactionId: 'fallback_' + Date.now(),
            sessionId: 'session_' + Date.now(),
            gameData: {
              gameMode,
              playerAddress: walletAddress,
              timestamp: Date.now(),
              action: "startGame",
              version: "fallback"
            }
          };
        },
        
        async endGameSession(sessionId, score, walletAddress) {
          console.log(`üèÅ Inline fallback: Ending game session ${sessionId} with score ${score}`);
          
          return {
            success: true,
            smartContractTxHash: '0x' + Math.random().toString(16).substr(2, 64),
            irysTransactionId: 'fallback_end_' + Date.now(),
            sessionId: sessionId
          };
        }
      };
      
      console.log('‚úÖ Inline fallback integration created');
    }
  </script>
  
  <!-- Load main application -->
  <script type="module" src="main-new.js"></script>
</body>
</html>